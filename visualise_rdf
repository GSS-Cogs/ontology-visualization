
#!/bin/bash

cwd=inout

query_file="$1"
img_type="$2"
shift
shift

results_file="$query_file.ttl"
dot_file="$query_file.dot"
img_file="$query_file.$img_type"

curl "$SPARQL_ENDPOINT" --data "query=$(cat "$query_file")" -X POST -H 'Accept:text/turtle' > "$results_file"

cd /workspace

pipenv run python ontology_viz.py -o "$cwd/$dot_file" -j namespace-overrides.json $@ "$cwd/$results_file"

cd $cwd
 
dot -T$img_type -o "$img_file" "$dot_file"

rm "$results_file"
rm "$dot_file"
